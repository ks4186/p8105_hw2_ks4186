---
title: "Homework 2"
author: "Kehan Su ks4186"
date: 2024-10-02
output: github_document
---

```{r setup, message=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
```

## Problem 2

## date cleaning for Mr TW
```{r}
MrTW_df = read_excel("./data/202409 Trash Wheel Collection Data.xlsx", sheet = 1) |>
  janitor::clean_names() |>
  select (-x15, -x16) |>
  filter(!is.na(dumpster)) |>
  mutate(sports_balls = as.integer(round(sports_balls, 0))) |>
  mutate(trash_wheel = "Mr. Trash Wheel") |>
  relocate (trash_wheel) |>
  mutate(year=as.character(year))
```

## data cleaning for Prof TW and Gwynnda TW
```{r}
ProfTW_df = read_excel("./data/202409 Trash Wheel Collection Data.xlsx", sheet = 2) |>
  janitor::clean_names() |>
  filter(!is.na(dumpster), !is.na(month)) |>
  mutate(trash_wheel = "Professor Trash Wheel") |>
  relocate (trash_wheel) |>
  mutate(year=as.character(year))

Gwyn_df = read_excel("./data/202409 Trash Wheel Collection Data.xlsx", sheet = 4) |>
  janitor::clean_names() |>
  filter(!is.na(dumpster), !is.na(month)) |>
  mutate(trash_wheel = "Gwynnda Trash Wheel") |>
  relocate (trash_wheel) |>
  mutate(year=as.character(year))
```

## merge together
```{r}
final_df = 
  bind_rows(MrTW_df,ProfTW_df,Gwyn_df) |>
  janitor::clean_names()
```

The final dataset contains 1032 observations of 15 variables, key variables include dumpster, month, year, date, weight, volume, types of trash (plastic bottles, cigarette butts, etc.)

```{r}
sum(pull(ProfTW_df, weight_tons), na.rm = TRUE)
```
The total weight of trash collected by Professor Trash Wheel is 246.74 tons.

```{r}
final_df |>
  filter(trash_wheel == "Gwynnda Trash Wheel", month == "June", year == "2022") |>
  summarise(Gwy_cigbutts_total = sum(cigarette_butts, na.rm = TRUE))
```
The total number of cigarette butts collected by Gwynnda in June of 2022 is 18120.

## Problem 3





